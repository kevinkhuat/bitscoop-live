{
  "provider": {
    "provider_number": "000000000000000000000006",
    "name": "Spotify",
    "client_callable": true,
    "domain": "https://api.spotify.com",
    "endpoint_wait_time": 0,
    "backend_name": "spotify",
    "auth_backend": "social.backends.spotify.SpotifyOAuth2",
    "description": "Music streaming service",
    "tags": [
      "media",
      "music"
    ],
    "auth_type": 0
  },
  "event_sources": {
    "playlists": {
      "display_name": "Spotify Playlists",
      "description": "Playlists you have created",
      "enabled_by_default": true,
      "endpoints": [
        "playlists",
        "me",
        "spotify_playlist_oembed"
      ],
      "initial_mapping": "playlists",
      "mappings": {
        "playlists": {
          "returned_data_location": "items",
          "type": "create",
          "db_entry_mapping": {
            "data": {
              "main": {
                "unique_identifiers": [
                  {
                    "hydration_method": "translate",
                    "value": "permission.event_source.name"
                  },
                  {
                    "hydration_method": "translate",
                    "value": "responseObject.id"
                  }
                ]
              }
            },
            "event": {
              "unique_identifiers": [
                {
                  "hydration_method": "literal",
                  "value": "playlist"
                },
                {
                  "hydration_method": "translate",
                  "value": "responseObject.id"
                }
              ],
              "mapped_fields": {
                "provider_name": {
                  "hydration_method": "literal",
                  "type": "string",
                  "value": "spotify"
                }
              }
            },
            "content": {
              "playlists": {
                "unique_identifiers": [
                  {
                    "hydration_method": "literal",
                    "value": "playlist"
                  },
                  {
                    "hydration_method": "translate",
                    "value": "responseObject.id"
                  }
                ],
                "mapped_fields": {
                  "embed_content": {
                    "hydration_method": "endpoint",
                    "value": {
                      "endpoint": "spotify_playlist_oembed",
                      "parameter_sources": {
                        "url": {
                          "hydration_method": "translate",
                          "value": "responseObject.uri"
                        }
                      },
                      "value_location": [
                        [
                          "html"
                        ]
                      ]
                    }
                  },
                  "embed_format": {
                    "hydration_method": "literal",
                    "value": "iframe"
                  },
                  "thumbnail": {
                    "hydration_method": "endpoint",
                    "value": {
                      "endpoint": "spotify_playlist_oembed",
                      "parameter_sources": {
                        "url": {
                          "hydration_method": "translate",
                          "value": "responseObject.uri"
                        }
                      },
                      "value_location": [
                        [
                          "thumbnail_url"
                        ]
                      ]
                    }
                  },
                  "title": {
                    "hydration_method": "translate",
                    "value": "responseObject.name"
                  },
                  "type": {
                    "hydration_method": "literal",
                    "type": "string",
                    "value": "audio"
                  },
                  "url": {
                    "hydration_method": "translate",
                    "value": "responseObject.external_urls.spotify"
                  }
                }
              }
            }
          }
        },
        "pagination": {
          "method": "nextPage",
          "next_link_location": "next"
        }
      }
    },
    "saved_tracks": {
      "display_name": "Spotify Saved Tracks",
      "name": "saved_tracks",
      "description": "Tracks you have saved",
      "enabled_by_default": true,
      "endpoints": [
        "saved_tracks",
        "spotify_track_oembed"
      ],
      "initial_mapping": "saved_tracks",
      "mappings": {
        "saved_tracks": {
          "returned_data_location": "items",
          "type": "play",
          "db_entry_mapping": {
            "data": {
              "main": {
                "unique_identifiers": [
                  {
                    "hydration_method": "translate",
                    "value": "permission.event_source.name"
                  },
                  {
                    "hydration_method": "translate",
                    "value": "responseObject.track.id"
                  }
                ]
              }
            },
            "event": {
              "unique_identifiers": [
                {
                  "hydration_method": "literal",
                  "value": "saved_track"
                },
                {
                  "hydration_method": "translate",
                  "value": "responseObject.track.id"
                }
              ],
              "mapped_fields": {
                "datetime": {
                  "hydration_method": "translate",
                  "type": "string",
                  "value": "responseObject.added_at"
                },
                "provider_name": {
                  "hydration_method": "literal",
                  "type": "string",
                  "value": "spotify"
                }
              }
            },
            "content": {
              "tracks": {
                "unique_identifiers": [
                  {
                    "hydration_method": "literal",
                    "value": "saved_tracks"
                  },
                  {
                    "hydration_method": "translate",
                    "value": "responseObject.track.id"
                  }
                ],
                "mapped_fields": {
                  "embed_content": {
                    "hydration_method": "endpoint",
                    "value": {
                      "endpoint": "spotify_track_oembed",
                      "parameter_sources": {
                        "url": {
                          "hydration_method": "translate",
                          "value": "responseObject.track.uri"
                        }
                      },
                      "value_location": [
                        [
                          "html"
                        ]
                      ]
                    }
                  },
                  "embed_format": {
                    "hydration_method": "literal",
                    "value": "iframe"
                  },
                  "thumbnail": {
                    "hydration_method": "endpoint",
                    "value": {
                      "endpoint": "spotify_track_oembed",
                      "parameter_sources": {
                        "url": {
                          "hydration_method": "translate",
                          "value": "responseObject.track.uri"
                        }
                      },
                      "value_location": [
                        [
                          "thumbnail_url"
                        ]
                      ]
                    }
                  },
                  "title": {
                    "hydration_method": "translate",
                    "value": "responseObject.track.name"
                  },
                  "type": {
                    "hydration_method": "literal",
                    "type": "string",
                    "value": "audio"
                  },
                  "url": {
                    "hydration_method": "translate",
                    "value": "responseObject.track.external_urls.spotify"
                  }
                }
              }
            }
          }
        },
        "pagination": {
          "method": "nextPage",
          "next_link_location": "next"
        }
      }
    }
  },
  "endpoints": {
    "playlists": {
      "call_method": "GET",
      "path": "v1/users/[$1]/playlists",
      "additional_path_fields": [
        {
          "description": "ID of the user",
          "parameter": "user_id",
          "replace": "[$1]"
        }
      ],
      "parameter_descriptions": {
        "limit": {
          "description": "Pagination counts",
          "hydration_method": "literal",
          "value": "50"
        },
        "next_url": {
          "description": "The URL for the next page",
          "hydration_method": "translate",
          "value": "connection.endpoint_data.playlists.playlists.next_url"
        },
        "user_id": {
          "description": "The user's ID",
          "hydration_method": "endpoint",
          "value": {
            "endpoint": "me",
            "value_location": [
              [
                "id"
              ]
            ]
          }
        }
      },
      "header_descriptions": {
        "access_token": {
          "description": "OAuth2 access key",
          "header_name": "Authorization",
          "header_value": "Bearer [$1]",
          "hydration_method": "server",
          "value": "auth_data.access_token"
        }
      }
    },
    "saved_tracks": {
      "call_method": "GET",
      "path": "v1/me/tracks",
      "parameter_descriptions": {
        "limit": {
          "description": "Pagination counts",
          "hydration_method": "literal",
          "value": "50"
        },
        "next_url": {
          "description": "The URL for the next page",
          "hydration_method": "translate",
          "value": "connection.endpoint_data.saved_tracks.saved_tracks.next_url"
        }
      },
      "header_descriptions": {
        "access_token": {
          "description": "OAuth2 access key",
          "header_name": "Authorization",
          "header_value": "Bearer [$1]",
          "hydration_method": "server",
          "value": "auth_data.access_token"
        }
      }
    },
    "me": {
      "call_method": "GET",
      "path": "v1/me",
      "header_descriptions": {
        "access_token": {
          "description": "OAuth2 access key",
          "header_name": "Authorization",
          "header_value": "Bearer [$1]",
          "hydration_method": "server",
          "value": "auth_data.access_token"
        }
      }
    },
    "spotify_playlist_oembed": {
      "call_method": "GET",
      "url": "https://embed.spotify.com/oembed/?url=[__url__]",
      "additional_path_fields": [
        {
          "description": "URL of Spotify object",
          "parameter": "url",
          "replace": "[__url__]"
        }
      ],
      "parameter_descriptions": {
        "url": {
          "description": "URL of Spotify object",
          "hydration_method": "translate",
          "value": "responseObject.uri"
        }
      }
    },
    "spotify_track_oembed": {
      "call_method": "GET",
      "url": "https://embed.spotify.com/oembed/?url=[__url__]",
      "additional_path_fields": [
        {
          "description": "URL of Spotify object",
          "parameter": "url",
          "replace": "[__url__]"
        }
      ],
      "parameter_descriptions": {
        "url": {
          "description": "URL of Spotify object",
          "hydration_method": "translate",
          "value": "responseObject.track.uri"
        }
      }
    }
  }
}