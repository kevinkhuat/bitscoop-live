<!DOCTYPE html>
<html lang="en-US">
	<head>{% load staticfiles %}
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />

		{% block meta %}
		<title>{{ title }}</title>
		<link rel="shortcut icon" href="{% static 'assets/img/favicon.png' %}" />
		<link rel="manifest" href="{% static 'assets/manifest.json'  %}">
		<link rel="apple-touch-icon" href="{% static 'assets/logo_240.png' %}">
		<meta name="apple-mobile-web-app-capable" content="yes">
		{% endblock %}

		{% block static %}
        {# TODO: Dependancy problems with libraries need to be fixed with require #}
		<script type="text/javascript" src="https://code.jquery.com/jquery-latest.min.js"></script>
		<script type="text/javascript" src="{% static 'lib/require/require.js' %}"></script>
		<script type="text/javascript" src="{% static 'core/js/main/utils/cookies.js' %}"></script>

		<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Lato:300,400,700|Source+Sans+Pro:300,400,700" />

		<script type="text/javascript" src="{% static 'shared/js/site.js' %}"></script>

		<link rel="stylesheet" type="text/css" href="{% static 'lib/icomoon/fonticons.css' %}" />
		<link rel="stylesheet" type="text/css" href="{% static 'shared/css/site-light.css' %}" />

		<script type="text/javascript">
			$(document).ready(function() {
				require(['site'], function(site) {
					site.bindMainAppUtilities();
				})
			});
		</script>

		<script type="text/javascript">
			(function(i, s, o, g, r, a, m) {
				i['GoogleAnalyticsObject'] = r;
				i[r] = i[r] || function() {
							(i[r].q = i[r].q || []).push(arguments)
						}, i[r].l = 1 * new Date();
				a = s.createElement(o),
						m = s.getElementsByTagName(o)[0];
				a.async = 1;
				a.src = g;
				m.parentNode.insertBefore(a, m)
			})(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

			ga('create', 'UA-65896068-1', 'auto');
			ga('send', 'pageview');
		</script>
		{% endblock %}
	</head>

	<body class="flex {{ body_class }} {% if request.mobile %}mobile{% endif %}">
		{% block body %}
		<header class="bg foreground bordered bottom {{ header_class }}">
			<nav class="flex stretch lockwidth {% if lockwidth_override %}override {% endif %}centered">
				<div class="flex wrap grow">
					{% block branding %}
					<a id="logo" class="item" href="{% url 'core_index' %}"><img src="{% static 'assets/img/logo_240.png' %}" alt="Ografy" /></a>
					{% endblock %}

					<div class="flex navlinks">
					{% if providers == undefined %}
						<a class="item link" href="{% url 'core_providers' %}"><i class="icon-plus"></i></a>
						{% endif %}

						{% if not request.user.is_authenticated %}
						<a class="item" href="http://blog.ografy.io" target="_blank"><i class="icon-file-text"></i></a>
						{% endif %}
						<a class="item" href="/help/documentation/account"><i class="icon-help"></i></a>
						{% if request.user.is_authenticated %}
						<div class="item link">
							<a class="user-button item">{{ request.user.identifier }}</a>
							<div class="flex column menu main hidden">
								<a class="item" href="{% url 'core_settings_account' %}">
									<i class="icon-cog" ></i>
									Settings
								</a>
								<a class="item" href="{% url 'core_logout' %}">
									<i class="icon-sign-out"></i>
									Logout
								</a>
							</div>
						</div>
						{% else %}
						<a class="item link" href="{% url 'core_signup' %}">
							<i class="icon-clippy"></i>
							Sign Up
						</a>
						<a class="item link" href="{% url 'core_login' %}">
							<i class="icon-sign-in"></i>
							Log In
						</a>
						{% endif %}
					</div>
				</div>
			</nav>
			{% block sub-header %}
			{% endblock %}
		</header>

		<main class="{% if providers_override %}flex {% endif %}grow {{ main_class }}">
			{% block main %}
			<div class="flex {% if flex_override %}flex_override {% endif %}grow lockwidth {% if lockwidth_override %}override {% endif %}centered">
				<aside id="left" class="{{ left_class }}">{% block left %}{% endblock %}</aside>
				<div id="content" class="grow {{ content_class }}">{% block content %}{% endblock %}</div>
				<aside id="right" class="{{ right_class }}">{% block right %}{% endblock %}</aside>
			</div>
			{% endblock %}
		</main>

		{% endblock %}
	</body>
</html>
